<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alumni Form</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- (Previous CSS - unchanged) --- */
        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 0;
            position: relative;
            overflow-x: hidden;
        }
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('https://raw.githubusercontent.com/ROWNIE77/RCAlumniforms/main/1.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            filter: blur(0px);
            z-index: -1;
        }

        /* Styles for the landing screen */
        .landing-screen {
            position: fixed; /* Or absolute, depending on layout needs */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.75); /* Semi-transparent white - slightly less transparent */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000; /* Make sure it's above the blurred background */
            transition: opacity 0.5s ease; /* Smooth transition for opacity */

            /* Opening animation */
            opacity: 0; /* Start invisible */
            transform: translateY(-50px); /* Start slightly above */
            animation: fadeInSlideDown 0.8s ease forwards;

        }

        @keyframes fadeInSlideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 0.98; /* Match the background opacity */
                transform: translateY(0);
            }
        }


      .landing-container {
        background-color: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        max-width: 600px; /* Adjust as needed */
        width: 90%;      /* Make it responsive */
        text-align: left; /* Align text to the left within the container */
      }

        .landing-screen h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            color: #333; /* Adjust color as needed */
           /* Opening animation for the title - slightly delayed */
            opacity: 0;
            transform: scale(0.8);
            animation: fadeInScaleUp 0.6s ease 0.2s forwards; /* 0.2s delay */

        }
    @keyframes fadeInScaleUp {
        from {
            opacity: 0;
            transform: scale(0.8);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }


        .landing-screen p {
            text-align: left; /* Align text to the left */
            margin: 10px 0;
            max-width: 100%; /* Ensure it doesn't overflow the container */
            line-height: 1;  /* Single spacing */
            color: #555; /* Adjust color as needed */

             /* Opening Animation for the instructions */
            opacity: 0;
            transform: translateX(-20px);
            animation: slideInLeft 0.5s ease 0.4s forwards;  /* 0.4s delay */

        }
          @keyframes slideInLeft { /* reused the animation from before */
            from {
                transform: translateX(-20px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        .landing-screen strong{
           font-size: 1.1em;
        }

        .landing-screen button {
            background-color: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 30px;
            font-size: 1.2em;
            font-weight: 500;
            transition: background-color 0.3s ease;
            display: block;  /* Make the button a block element */
            margin-left: auto; /* Push the button to the right */
            margin-right: auto; /*Push the button to the center */

            /* Opening Animation for the button */
            opacity: 0;
            transform: scale(0.7);
            animation: fadeInScaleUp 0.6s ease 0.6s forwards;  /* 0.6s delay */

        }

        .landing-screen button:hover {
            background-color: #45a049;
        }

        .hidden {
            display: none !important; /* Use !important to override other styles */
        }

        .fade-out {
          opacity: 0; /* Start with 0 opacity */
          pointer-events: none; /* Prevent clicks on the fading element */
        }

        /* --- Main Container Styles --- */
        .main-container {
            max-width: 650px; /* Slightly larger than the form */
            margin: 40px auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            overflow: hidden; /* Hide overflowing content */
            position: relative; /* For absolute positioning of tabs */
            padding-top: 40px; /* Make space for tabs */
        }

        /* --- Tab Styles --- */
        .tabs {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            background-color: #f0f0f0; /* Light gray background for tabs */

        }

        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 8px 8px 0 0; /* Rounded top corners */
            background-color: #ddd; /* Slightly darker for inactive tabs */
            margin-right: 2px; /* Space between tabs */
            font-weight: bold;
            transition: background-color 0.3s;
            user-select: none;  /* Prevent text selection */
            border: 1px solid #ccc;
        }

        .tab.active {
            background-color: white; /* Active tab is white */
            border-bottom: 1px solid white; /* Hide the bottom border */
        }

        /* --- Panel Styles --- */
        .panel {
            padding: 30px;
             /* Initially hide all panels except the first */
             display: none;

        }

        .panel.active {
            display: block;
               /* fadeInUp animation */
            animation: fadeInUp 0.5s ease-out;

        }
           /* Signature Pad Styles */

        .signature-pad {
            border: 1px solid #ddd;
            border-radius: 4px;
        }


        /* --- Existing form styles (modified for panel) --- */
       /* Existing form styles */
        .alumni-form { /* Changed from 'form' to a class */
            /* Remove max-width, margin, padding, background, box-shadow, border-radius from here */
            /* They are now applied to .main-container and .panel */
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.5s ease-out forwards;
        }
        @keyframes fadeInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        .logo {
            display: block;
            margin: 0 auto 20px;
            max-width: 150px;
            height: auto;
        }

        h2 {
            text-align: center;
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
            animation: fadeIn 1s ease-out;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        label {
            display: block;
            margin: 15px 0 5px;
            font-weight: 500;
            animation: slideInLeft 0.5s ease-out;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
            transition: all 0.3s ease;
        }
        .example-text {
            color: gray;
            font-style: italic;
            opacity: 0.7;
            font-size: 0.875em;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.6);
        }
        textarea {
            resize: none;
        }
        canvas {
            border: 1px solid #000;
            margin-bottom: 15px;
            transition: border-color 0.3s ease;
        }
        canvas:focus {
            border-color: #4CAF50;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            font-family: 'Roboto', Arial, sans-serif;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        button:hover {
            background-color: #45a049;
            transform: scale(1.05);

        }
        #clearSignature {
            background-color: #ff6347;
        }
        .button-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        .left-buttons {
            display: flex;
            gap: 10px;
        }
        input:placeholder-shown, textarea:placeholder-shown {
            background-color: #f0f8ff;
            border-color: #add8e6;
        }
        input:not(:placeholder-shown), textarea:not(:placeholder-shown) {
            background-color: white;
            border-color: #ddd;
        }
        .error {
            border-color: red !important;
        }
        #loadingSpinner {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4CAF50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* --- ID Tracker Styles --- */
        .id-tracker-panel {
            text-align: center;
            color: #333;
            animation: fadeIn 1s ease-out;
        }

        .id-tracker-panel h3 {
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .id-tracker-panel input[type="text"] {
            margin-bottom: 20px;
        }

        .id-tracker-panel p {
            font-size: 1em;
            margin-bottom: 30px;
            text-align: justify;
        }
.id-tracker-results p {
    text-align: center; /* Center the text within the paragraphs */
    margin: 10px 0;  /* Add some vertical margin */
}
        .id-tracker-results {
            margin-top: 20px;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 4px;
            background-color: #f9f9f9;
            overflow-y: auto;
            display: none;
            max-height: 200px;
        }
        .status-display{
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;

        }
        .status-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }
        .status-icon.received {
            background-color: #f0ad4e;
            color: white;
        }

        .status-icon.printing {
            background-color: #5bc0de;
            color: white;
        }

        .status-icon.claiming {
            background-color: #5cb85c;
            color: white;
        }
        .status-text{
            font-size: 1.1em;
            font-weight: bold;
        }
        .results-label {
            font-weight: bold;
            display: block;
            text-align: center;
            margin-bottom: 5px;
        }
        /* Add a container for the search spinner */
        .search-spinner-container {
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
            margin-top: 10px; /* Add some space above */

        }

        .search-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4CAF50;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto; /* Center horizontally */

        }

        footer {
            text-align: center;
            padding: 10px;
            font-size: 14px;
            background: rgba(0, 0, 0, 0);
            margin-top: 20px;
            color: #ffffff;
        }

        footer p {
          margin: 0;
          padding: 0;
        }

    </style>
</head>
<body>

<!-- Landing Screen -->
<div class="landing-screen" id="landingScreen">
  <div class="landing-container">
    <h1>WELCOME</h1>
    <p><strong>General Instructions:</strong></p>
      <p><strong>Submission:</strong> Only Click the submit button once, wait for the confirmation page to appear before exiting the forms.</p>
      <p><strong>Response:</strong> You are allowed to submit one form. Never fill out again if advised by your adviser to do so.</p>
      <p><strong>Signature:</strong> There is a canvas below the forms that can record signature strokes without the need of an upload section. You can reset the canvas using the Clear signature button below.</p>
      <p><strong>Section:</strong> Type your section name in this format ( ex: St. Hannibal).</p>
    <button id="startButton">Start</button>
  </div>
</div>

<!-- Main Container -->
<div class="main-container hidden" id="mainContainer">  <!-- Initially hidden -->

    <!-- Tabs -->
    <div class="tabs">
        <div class="tab active" data-panel="form-panel">Forms</div>
        <div class="tab" data-panel="id-tracker-panel">Alumni ID Tracker</div>
    </div>

    <!-- Form Panel -->
    <div class="panel active" id="form-panel">
        <form id="alumniForm" class="alumni-form">  <!-- Changed to a class -->
           <!-- Add the logo here -->
            <img src="https://raw.githubusercontent.com/ROWNIE77/RCAlumniforms/main/2.png" alt="Logo" class="logo">

            <h2>ALUMNI INFORMATION FORM</h2>
            <p style="text-align: justify; font-style: italic; font-family: 'Roboto', Arial, sans-serif;">
                <strong>Data Privacy Notice:</strong> In compliance with the Data Privacy Act of 2012 (RA 10173), we are committed to protecting your personal information. By clicking "Submit," you confirm that you voluntarily provide your data for the purpose of Alumni Data Collection.
            </p>
            <p style="text-align: justify; font-style: italic; font-family: 'Roboto', Arial, sans-serif;">
                Your information will be kept confidential and used only by Rogationist College for internal purposes, such as school records and communication.
            </p>

            <label for="firstName">First Name:</label>
            <input type="text" id="firstName" name="firstName" required placeholder="Enter your first name">

            <label for="lastName">Last Name:</label>
            <input type="text" id="lastName" name="lastName" required placeholder="Enter your last name">

            <label for="middleName">Middle Name:</label>
            <input type="text" id="middleName" name="middleName" placeholder="Enter your middle name">

            <label for="department">Department:</label>
            <select id="department" name="department" required>
                <option value="">Select Department</option>
                <option value="JHS">JHS</option>
                <option value="SHS">SHS</option>
                <option value="College">College</option>
                <option value="TED">TED</option>
            </select>

            <div id="strands" style="display:none;">
                <label for="strand">SHS Strand:</label>
                <select id="strand" name="strand">
                    <option value="">Select Strand</option>
                    <option value="ABM">ABM</option>
                    <option value="STEM">STEM</option>
                    <option value="HUMSS">GA - HUMSS</option>
                </select>
            </div>

            <div id="courses" style="display:none;">
                <label for="course">College Course:</label>
                <select id="course" name="course">
                    <!-- Courses will be populated by JavaScript -->
                </select>
            </div>

            <label for="batch">Batch:</label>
            <select id="batch" name="batch" required>
                <!-- Years will be populated by JavaScript -->
            </select>

            <label for="section">Section:<span style="color: gray; font-style: italic; opacity: 0.7; font-size: smaller;";>(ex: St. Hannibal)</span></label>
            <input type="text" id="section" name="section" required placeholder="Enter your section">

            <label for="birthdate">Birthdate:</label>
            <input type="date" id="birthdate" name="birthdate" required placeholder="Enter your birthdate">

            <label for="phone">Phone Number:<span style="color: gray; font-style: italic; opacity: 0.7; font-size: smaller;";>(ex:09201231234)</span></label>
            <input type="tel" id="phone" name="phone" pattern="\d{11}" required placeholder="Enter your phone number">

            <label for="gmail">Gmail:</label>
            <input type="email" id="gmail" name="gmail" required placeholder="Enter your Gmail">

            <label for="address">Address:</label>
            <textarea id="address" name="address" required placeholder="Enter your address"></textarea>

            <label for="emergencyContact">Emergency Contact:</label>
            <input type="text" id="emergencyContact" name="emergencyContact" required placeholder="Enter emergency contact">

            <label for="emergencyPhone">Emergency Phone:<span style="color: gray; font-style: italic; opacity: 0.7; font-size: smaller;";>(ex:09201231234)</span></label>
            <input type="tel" id="emergencyPhone" name="emergencyPhone" pattern="\d{11}" required placeholder="Enter emergency phone">

            <label for="emergencyAddress">Emergency Address:</label>
            <textarea id="emergencyAddress" name="emergencyAddress" required placeholder="Enter emergency address"></textarea>

             <label for="signature">Signature:</label>
           <canvas id="signatureCanvas" width="300" height="150" class="signature-pad"></canvas>
            <input type="hidden" id="signatureData" name="Signature (Base64)">

            <!-- Suggestion Box -->
            <label for="suggestion">Suggestion (Optional):</label>
            <textarea id="suggestion" name="suggestion" placeholder="Enter your suggestion"></textarea>

            <!-- Guide for submitting form -->
            <p style="text-align: center; font-style: italic; font-family: 'Roboto', Arial, sans-serif; font-size: smaller;">
                After clicking the <b>submit</b> button, please wait for the confirmation message to appear before clicking again. Clicking the <b>clear signature</b> will only reset the canvas and clicking the <b>reset form</b> will reset the whole form.
            </p>

            <!-- Buttons -->
                <div class="button-group">
                    <div class="left-buttons">
                        <button type="button" id="clearSignature">Clear Signature</button>
                        <button type="submit" id="submitButton">Submit</button>
                    </div>
                    <div class="right-button">
                        <button type="button" id="resetForm">Reset Form</button>
                    </div>
                </div>

            <!-- Loading Spinner -->
            <div id="loadingSpinner">
                <div class="spinner"></div>
                <p>Submitting...</p>
            </div>
        </form>
    </div> <!-- End Form Panel -->


    <!-- ID Tracker Panel -->
    <div class="panel" id="id-tracker-panel">
        <div class="id-tracker-panel">
            <h3>Alumni ID Tracker</h3>
            <p>
                Welcome to the Alumni ID Tracker.  Please enter your Batch, Section, and complete name (First Name, Middle Name, Last Name) in the fields below. Ensure that the information you provide matches the details you submitted in the Alumni Information Form.
            </p>
            <input type="text" id="searchBatch" placeholder="Enter Batch (e.g., 2015)">
            <input type="text" id="searchSection" placeholder="Enter Section (e.g., St. Hannibal)">
            <input type="text" id="searchFirstName" placeholder="Enter First Name">
            <input type="text" id="searchMiddleName" placeholder="Enter Middle Name">
            <input type="text" id="searchLastName" placeholder="Enter Last Name">

            <button type="button" id="searchButton">Search</button>

             <!-- Container for the search spinner -->
            <div class="search-spinner-container">
                <div class="search-spinner"></div>
            </div>

            <div class="id-tracker-results">
                <span class="results-label">Search Results:</span>
                <!-- Results will be displayed here -->
            </div>
        </div>
    </div>


</div> <!-- End Main Container -->

 <!-- Footer -->
    <footer>
        <p>Designed and Developed by
    </p>
    <p><strong>JHON RONEL N. NERVEZA</strong>
    </p>
    <p><i>Rogationist College Office of External Affairs</i>
    </p>
    </footer>

<script>
    // --- Landing Screen and Tab Switching ---
    const landingScreen = document.getElementById('landingScreen');
    const startButton = document.getElementById('startButton');
    const mainContainer = document.getElementById('mainContainer');
    const alumniForm = document.getElementById('alumniForm');
    const tabs = document.querySelectorAll('.tab');
    const panels = document.querySelectorAll('.panel');
    const searchButton = document.getElementById('searchButton');
    const idTrackerResults = document.querySelector('.id-tracker-results');
    const searchSpinnerContainer = document.querySelector('.search-spinner-container');

    // --- THIS IS THE CORRECTED PART FOR THE START BUTTON ---
    startButton.addEventListener('click', () => {
        landingScreen.classList.add('fade-out');
        setTimeout(() => {
            landingScreen.classList.add('hidden');
            mainContainer.classList.remove('hidden'); // Show the main container
        }, 500);
    });

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            panels.forEach(p => p.classList.remove('active'));
            tab.classList.add('active');
            const panelId = tab.dataset.panel;
            document.getElementById(panelId).classList.add('active');
        });
    });

    // --- Form Submission and Validation --- (Rest of your code)
   const form = document.getElementById('alumniForm');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const submitButton = document.getElementById('submitButton');

    const validateForm = () => {
        const requiredFields = form.querySelectorAll('[required]');
        let isValid = true;

        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                isValid = false;
                field.classList.add('error');
            } else {
                field.classList.remove('error');
            }
        });
        const phone = document.getElementById('phone').value;
        if (!/^\d{11}$/.test(phone)) {
            isValid = false;
            alert('Phone number must be 11 digits.');
        }

        return isValid;
    };

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        if (!validateForm()) {
            alert('Please fill out all required fields.');
            return;
        }
        loadingSpinner.style.display = 'block';
        submitButton.disabled = true;

        try {
            const response = await fetch('https://script.google.com/macros/s/AKfycbzFFWrwt87Ul9g6ScWC8TYf8nxGE_MBCns2WXNpnIZRCr_DlSNzsw-EMsWJPwk7xwxA3Q/exec', {
                method: 'POST',
                body: new FormData(form),
            });
            const data = await response.json();
            if (data.result === 'success') {
                alert('Form submitted successfully!');
            } else {
                alert('Error submitting the form: ' + data.error);
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while submitting the form.');
        } finally {
            loadingSpinner.style.display = 'none';
            submitButton.disabled = false;
        }
    });

    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;

    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);

    canvas.addEventListener('touchstart', startDrawing);
    canvas.addEventListener('touchmove', draw);
    canvas.addEventListener('touchend', stopDrawing);

    function startDrawing(e) {
        e.preventDefault();
        isDrawing = true;
        draw(e);
    }

    function draw(e) {
        if (!isDrawing) return;
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#000';

        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;

        let clientX, clientY;
        if (e.touches) {
            clientX = e.touches[0].clientX;
            clientY = e.touches[0].clientY;
        } else {
            clientX = e.clientX;
            clientY = e.clientY;
        }

        ctx.lineTo((clientX - rect.left) * scaleX, (clientY - rect.top) * scaleY);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo((clientX - rect.left) * scaleX, (clientY - rect.top) * scaleY);
    }

    function stopDrawing() {
        isDrawing = false;
        ctx.beginPath();
        document.getElementById('signatureData').value = canvas.toDataURL();
    }

    document.getElementById('clearSignature').addEventListener('click', function() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        document.getElementById('signatureData').value = '';
    });

    document.getElementById('resetForm').addEventListener('click', function() {
        document.getElementById('alumniForm').reset();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        document.getElementById('signatureData').value = '';
    });

    const batch = document.getElementById('batch');
    for(let year = 1991; year <= 2030; year++) {
        let option = document.createElement('option');
        option.value = year;
        option.text = year;
        batch.appendChild(option);
    }

    const department = document.getElementById('department');
    const strandsDiv = document.getElementById('strands');
    const coursesDiv = document.getElementById('courses');
    const courseSelect = document.getElementById('course');

    department.addEventListener('change', function() {
        strandsDiv.style.display = 'none';
        coursesDiv.style.display = 'none';
        if (this.value === 'SHS') {
            strandsDiv.style.display = 'block';
        } else if (this.value === 'College') {
            coursesDiv.style.display = 'block';
            populateCourses();
        }
    });

    function populateCourses() {
        const courses = [
            "Bachelor of Science in Accountancy",
            "Bachelor of Science in Business Administration Major in Marketing Management",
            "Bachelor of Science in Hospitality Management",
            "Bachelor of Science in Tourism Management",
            "Bachelor of Science in Information Technology",
            "Bachelor of Science in Electronics Engineering",
            "Bachelor of Science in Industrial Technology Major in Automotive Technology",
            "Bachelor of Science in Industrial Technology Major in Mechanical Technology",
            "Bachelor of Secondary Education Major in English",
            "Bachelor of Elementary Education"
        ];
        courseSelect.innerHTML = '<option value="">Select Course</option>';
        courses.forEach(course => {
            let option = document.createElement('option');
            option.value = course;
            option.text = course;
            courseSelect.appendChild(option);
        });
    }

    // --- ID Tracker Functionality --- (Modified)
    searchButton.addEventListener('click', async () => {
        const searchBatch = document.getElementById('searchBatch').value.trim();
        const searchSection = document.getElementById('searchSection').value.trim();
        const searchFirstName = document.getElementById('searchFirstName').value.trim();
        const searchMiddleName = document.getElementById('searchMiddleName').value.trim();
        const searchLastName = document.getElementById('searchLastName').value.trim();

        idTrackerResults.innerHTML = ''; // Clear previous results
        idTrackerResults.style.display = 'none'; // Hide results initially
        searchSpinnerContainer.style.display = 'flex'; // Show spinner

        if (!searchBatch || !searchSection || !searchFirstName || !searchLastName) {
            idTrackerResults.innerHTML = '<p>Please enter Batch, Section, First Name, and Last Name.</p>';
            idTrackerResults.style.display = "block";
            searchSpinnerContainer.style.display = 'none'; // Hide spinner if input is invalid
            return;
        }

        try {
            const response = await fetch('https://script.google.com/macros/s/AKfycbzFFWrwt87Ul9g6ScWC8TYf8nxGE_MBCns2WXNpnIZRCr_DlSNzsw-EMsWJPwk7xwxA3Q/exec?action=searchAlumni', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `searchBatch=${encodeURIComponent(searchBatch)}&searchSection=${encodeURIComponent(searchSection)}&searchFirstName=${encodeURIComponent(searchFirstName)}&searchMiddleName=${encodeURIComponent(searchMiddleName)}&searchLastName=${encodeURIComponent(searchLastName)}`
            });

            const data = await response.json();

            if (data.result === 'success' && data.data.length > 0) {
                // We'll only process the *first* match, for simplicity.
                const alumnus = data.data[0];
                let statusHtml = '';

                // Create the visual status display based on idStatus
                switch (alumnus.idStatus) {
                    case 'Order Received':
                        statusHtml = `
                            <div class="status-display">
                                <div class="status-icon received">✔</div>
                                <div class="status-text">Order Received</div>
                            </div>
                            <p>Your alumni ID order has been received. We'll start processing it shortly.</p>
                        `;
                        break;
                    case 'Printing Order':
                        statusHtml = `
                            <div class="status-display">
                                <div class="status-icon printing">✍</div>
                                <div class="status-text">Printing Order</div>
                            </div>
                            <p>Your alumni ID is currently being printed.  It's almost ready!</p>
                        `;
                        break;
                        case 'ID is for Claiming':
                        statusHtml = `
                            <div class="status-display">
                                <div class="status-icon claiming"></div>
                                <div class="status-text">ID is for Claiming</div>
                            </div>
                            <p>Your alumni ID is now ready for claiming! Please visit the Alumni Office.</p>
                        `;
                        break;
                    default:
                        statusHtml = `<p>Unknown status: ${alumnus.idStatus}</p>`;
                }

                idTrackerResults.innerHTML = statusHtml; // Set the entire content
                idTrackerResults.style.display = "block";

            } else if (data.result === 'success' && data.data.length === 0) {
                idTrackerResults.innerHTML = "<p>No matching alumni record found.</p>";
                idTrackerResults.style.display = "block";
            } else {
                idTrackerResults.innerHTML = `<p>Error: ${data.error || 'An unknown error occurred.'}</p>`;
                idTrackerResults.style.display = "block";
            }

        } catch (error) {
            console.error('Error:', error);
            idTrackerResults.innerHTML = '<p>An error occurred while searching.</p>';
            idTrackerResults.style.display = "block";
        } finally {
            searchSpinnerContainer.style.display = 'none'; // Hide spinner after search completes (success or error)
        }
    });
</script>
</body>
